# API Proxy Logger

Этот проект представляет собой PHP прокси-сервер для перехвата и логирования API запросов с целью анализа поведения недобросовестных приложений.

## Назначение

### Основная цель
Прокси предназначен для **анализа и документирования API запросов** от приложений, которые могут:
- Нарушать пользовательские соглашения
- Использовать API способами, не предусмотренными разработчиками
- Обходить ограничения или механизмы безопасности
- Злоупотреблять ресурсами сервиса

### Практические применения

1. **Исследование поведения приложений**
   - Анализ паттернов запросов от подозрительных приложений
   - Выявление попыток обхода ограничений API
   - Документирование несанкционированного использования

2. **Создание защитных механизмов**
   - На основе собранных логов можно создавать модификаторы API
   - Блокировка или ограничение подозрительных запросов
   - Внедрение дополнительной валидации

3. **Мониторинг и аналитика**
   - Отслеживание частоты и типов запросов
   - Выявление аномального поведения
   - Сбор статистики использования API

## Принцип работы

1. **Перехват**: Приложение делает запрос к прокси вместо оригинального API
2. **Логирование**: Прокси сохраняет полную информацию о запросе и ответе
3. **Проксирование**: Запрос передается на оригинальный API без изменений
4. **Возврат**: Ответ API возвращается приложению без изменений

## Целевой API

По умолчанию настроен для работы с: `https://vpvpay.store/api/`

## Структура проекта

```
/
├── index.php          # Главная страница со статусом прокси
├── api/
│   ├── proxy.php      # Основная логика прокси
│   ├── index.php      # Обработчик запросов в папке api
│   └── .htaccess      # Настройки маршрутизации для api
├── logs/
│   ├── api_log.json   # Файл логов (создается автоматически)
│   ├── .htaccess      # Блокировка веб-доступа к логам
│   └── README.md      # Описание структуры логов
├── config.php         # Настройки конфигурации
├── README.md          # Документация (English)
├── README_ru.md       # Документация (Русский)
└── .htaccess          # Основные настройки маршрутизации
```

## Использование логов

Собранные логи можно использовать для:
- **Анализа паттернов**: Выявление повторяющихся подозрительных запросов
- **Создания фильтров**: Разработка правил для блокировки нежелательного трафика
- **Модификации API**: Внедрение дополнительных проверок и ограничений
- **Исследований безопасности**: Изучение методов обхода защиты

## Этические соображения

⚠️ **Важно**: Данный инструмент предназначен для:
- Защиты собственных API от злоупотреблений
- Исследований в области информационной безопасности
- Анализа поведения приложений с согласия владельца

Использование для незаконного перехвата чужого трафика или нарушения приватности запрещено.

## Установка

1. Загрузите все файлы на ваш веб-сервер
2. Убедитесь, что включен Apache mod_rewrite
3. Установите права на запись для директории `logs/`
4. Откройте главную страницу для проверки статуса прокси

## Использование

- Отправляйте запросы на `/api/[endpoint]`
- Пример: `/api/users` будет проксирован на `https://vpvpay.store/api/users`
- Все запросы и ответы логируются в `logs/api_log.json`
- Просмотр статуса прокси доступен по корневому URL

## Возможности

- ✅ Полное логирование запросов/ответов
- ✅ Предотвращение дублирования записей
- ✅ Поддержка всех HTTP методов
- ✅ Передача заголовков и тела запроса
- ✅ Автоматическая ротация логов (последние 1000 записей)
- ✅ Ограничения безопасности на доступ к логам
- ✅ Настраиваемые таймауты

## Формат логов

Каждая запись лога содержит:
```json
{
  "timestamp": "2024-01-15 10:30:45",
  "request_hash": "md5_хеш_запроса",
  "request": {
    "method": "POST",
    "url": "https://vpvpay.store/api/endpoint",
    "headers": {...},
    "body": "данные_запроса"
  },
  "response": {
    "code": 200,
    "headers": {...},
    "body": "данные_ответа"
  }
}
```

Этот формат упрощает анализ поведения API и создание соответствующих контрмер для недобросовестных приложений.